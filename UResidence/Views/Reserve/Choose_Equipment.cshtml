@model IEnumerable<object>
@{
    List<object> equip1 = Model.ToList()[0] as List<object>;
    List<UResidence.Equipment> equip = Model.ToList()[1] as List<UResidence.Equipment>;
    ViewBag.Title = "Choose_Equipment";
    if (Convert.ToInt32(Session["Level"]) == 8)
    {
        Layout = "~/Views/Layout/LayoutHome.cshtml";
    }
    else if (Convert.ToInt32(Session["Level"]) == 9)
    {
        Layout = "~/Views/Layout/TenantLayout.cshtml";
    }
    else
    {
        Layout = "/Views/Layout/AdminLayout.cshtml";
    }
    int totaleq = 0;
    int[] stocks = new int[equip.Count()];
    int eqt = 0;
}



@if (Convert.ToInt32(Session["Level"]) <= 7)
	{
@*Scripts for dropdown*@
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	}



<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <style>


        body {
            /*background-color: #dcedc8;*/
            background: url(../../Content/WebImages/swimmingbg.jpg) no-repeat center center fixed;
            -webkit-background-size: cover;
            -moz-background-size: cover;
            -o-background-size: cover;
            background-size: cover;
        }



        .col-25 {
            float: left;
            width: 25%;
            margin-top: 6px;
        }


        .col-75 {
            float: left;
            width: 75%;
            margin-top: 6px;
        }

        label {
            padding: 12px 12px 12px 0;
            display: inline-block;
        }

        .row:after {
            content: "";
            display: table;
            clear: both;
        }

        .button {
            padding: 15px 25px;
            font-size: 15px;
            text-align: center;
            cursor: pointer;
            outline: none;
            color: #fff;
            background-color: #09442c;
            border: none;
            border-radius: 5px;
            float: right;
            text-decoration: none;
            text-decoration-color: none;
        }



            .button:hover {
                background-color: #0e6742;
            }

        .db-pricing-seven {
            margin-bottom: 30px;
            margin-top: 30px;
            text-align: center;
            border: 1px solid #C5C2C2;
            background-color: #fafafa;
        }

            .db-pricing-seven:hover {
                margin-top: 5px;
                -moz-transition: margin-top 0.25s ease 0s;
                -ms-transition: margin-top 0.25s ease 0s;
                transition: margin-top 0.25s ease 0s;
            }

            .db-pricing-seven ul {
                list-style: none;
                margin: 0;
                text-align: center;
                padding-left: 0px;
            }

                .db-pricing-seven ul li {
                    /*border-bottom: solid 1px #D8D8D8;*/
                    padding-top: 20px;
                    padding-bottom: 20px;
                    cursor: pointer;
                    text-transform: uppercase;
                }

                    .db-pricing-seven ul li.price {
                        background-color: #f5f5f5;
                        padding: 40px 20px 20px 20px;
                        font-size: 20px;
                        font-weight: 900;
                        /*color: #353c3e;*/
                        font-weight: 900;
                    }

                        .db-pricing-seven ul li.price i {
                            padding: 30px;
                            font-size: 50px;
                            display: block;
                        }


            .db-pricing-seven .pricing-footer {
                padding: 20px;
            }

                .db-pricing-seven .pricing-footer a i {
                    margin: 5px;
                    top: 3px;
                }

        .pcolor {
            background-color: #fafafa;
        }
    </style>
</head>

<body>

    <br />
    <br />



    <center>
        <div class="container">
            <div class="progress" style="height:55px;">
                <div class="progress-bar progress-bar-success " role="progressbar" aria-valuenow="20"
                     aria-valuemin="0" aria-valuemax="100" style="width:20%;">
                    <a href="@Url.Action("Amenity", "Reserve")" style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif; padding-top:1em; padding-bottom:1em;"> <font color="white" size="3">Choose Amenity</font></p></a>
                </div>
                <div class="progress-bar progress-bar-success " style="width:20%;" role="progressbar" aria-valuenow="0"
                     aria-valuemin="0" aria-valuemax="100">
                    <a href="@Url.Action("Calendar", "Reserve")" style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em; padding-bottom:1em;"> <font color="white" size="3">Scheduled Amenity</font> </p></a>
                </div>


                @if (ViewBag.Amenity.ToUpper().Contains("SWIMMING"))
                {
                    <div class="progress-bar progress-bar-success" style="width:20%;" role="progressbar" aria-valuenow="0"
                         aria-valuemin="0" aria-valuemax="100">
                        <a href="@Url.Action("Swimming", "Reserve")" style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Choose Date</font> </p></a>
                    </div>
                }
                else
                {
                    <div class="progress-bar progress-bar-success" style="width:20%;" role="progressbar" aria-valuenow="0"
                         aria-valuemin="0" aria-valuemax="100">
                        <a href="@Url.Action("Choose_Date", "Reserve")" style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Choose Date</font> </p></a>
                    </div>
                }

                <div class="progress-bar progress-bar-success progress-bar-striped active " style="width:20%;" role="progressbar" aria-valuenow="0"
                     aria-valuemin="0" aria-valuemax="100">
                    <p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Choose Equipment</font> </p>
                </div>
                <div class="progress-bar  " style="background-color:#979797; width:20%;" role="progressbar" aria-valuenow="0"
                     aria-valuemin="0" aria-valuemax="100">
                    <p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Summary</font> </p>
                </div>
            </div>


        </div>
    </center>


    <div id="main">
        <div class="container">

            <div class="panel panel-default pcolor" style="box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.1), 0 3px 10px 0 rgba(0, 0, 0, 0.1);">
                <div class="panel-body" style="margin-left: 10px;margin-right: 10px;">



                    <div class="pricing-table pricing-three-column row">

                        @{int ctr3 = 0;
                            if (equip1.Count != 0)
                            {
                                if (equip.Count > 0)
                                {
                                    //Equipment
                                    foreach (var eqp in equip)
                                    {
                                        totaleq = eqp.Stocks;
                                        for (int i = 0; i <= equip1.Count - 1; i++)
                                        {

                                            if (eqp.Id == Convert.ToInt32(equip1[i]))
                                            {
                                                i++;
                                                totaleq -= Convert.ToInt32(equip1[i]);
                                                i--;
                                            }
                                        }
                                        if (totaleq < 0)
                                        {
                                            totaleq = 0;
                                        }
                                        <input type="hidden" id="eid" + @ctr3.ToString() name="eid" +@ctr3.ToString() value="@eqp.Id" />
                                        <input type="hidden" id="svalue @ctr3.ToString()" name="svalue @ctr3.ToString()" value="@totaleq" />





                                        <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                            <div class="db-wrapper">
                                                <div class="db-pricing-seven">
                                                    <ul>
                                                        <li class="price">
                                                            <img src="@Url.Content(eqp.Url)" height="25%" width="50%" />

                                                        </li>
                                                        <li>  <h3> @Html.DisplayFor(model => eqp.Name, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly", @id = "Name" } }) </h3> </li>
                                                        <li> @Html.DisplayFor(model => eqp.Description, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly" } }) </li>
                                                        <li> <label for="Quantity">Quantity :</label> <font color="black"> @Html.EditorFor(model => eqp.Stocks, new { htmlAttributes = new { @class = "form-group", @min = "0", @id = "txtQuantity" + ctr3.ToString(), @required = "required", name = "txtQuantity" + ctr3.ToString(), Value = 0, @max = totaleq } }) </font></li>
                                                        <li>  <label for="Stocks">Stocks :</label> <font color="black"> <label id="stocks1" name="stocks1">@totaleq</label> </font></li>


                                                        <li><label for="Rate">Rate :</label> <font color="black">  @Html.DisplayFor(model => eqp.Rate, new { htmlAttributes = new { @class = "form-group", @disabled = "true", @value = eqp.Rate, @id = "txtRate" + ctr3.ToString(), name = "txtRate" + ctr3.ToString() } })</font>  </li>
                                                        <br />
                                                    </ul>

                                                </div>
                                            </div>
                                        </div>
                                        ctr3++;
                                        totaleq = 0;
                                    }

                                }
                            }
                            else if (equip.Count > 0)
                            {
                                foreach (var eqp in equip)
                                {

                                    totaleq = eqp.Stocks;


                                    <input type="hidden" id="eid" + @ctr3.ToString() name="eid" +@ctr3.ToString() value="@eqp.Id" />
                                    <input type="hidden" id="svalue @ctr3.ToString()" name="svalue @ctr3.ToString()" value="@totaleq" />
                                    @Html.EditorFor(model => eqp.Rate, new { htmlAttributes = new { @class = "form-control", @Value = eqp.Rate, @id = "txtRate1" + ctr3.ToString(), name = "txtRate1" + ctr3.ToString(), @style = "display: none" } })




                                    <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                        <div class="db-wrapper">
                                            <div class="db-pricing-seven">
                                                <ul>
                                                    <li class="price">
                                                        <img src="@Url.Content(eqp.Url)" height="25%" width="50%" />

                                                    </li>
                                                    <li>  <h3> @Html.DisplayFor(model => eqp.Name, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly", @id = "Name" } }) </h3> </li>
                                                    <li> @Html.DisplayFor(model => eqp.Description, new { htmlAttributes = new { @class = "form-control", @readonly = "readonly" } }) </li>
                                                    <li> <label for="Quantity">Quantity :</label> <font color="black"> @Html.EditorFor(model => eqp.Stocks, new { htmlAttributes = new { @class = "form-group", @min = "0", @id = "txtQuantity" + ctr3.ToString(), @required = "required", name = "txtQuantity" + ctr3.ToString(), Value = 0, @max = totaleq } }) </font></li>
                                                    <li>  <label for="Stocks">Stocks :</label> <font color="black"> <label id="stocks1" name="stocks1">@totaleq</label> </font></li>


                                                    <li><label for="Rate">Rate :</label> <font color="black">  @Html.DisplayFor(model => eqp.Rate, new { htmlAttributes = new { @class = "form-group", @disabled = "true", @value = eqp.Rate, @id = "txtRate" + ctr3.ToString(), name = "txtRate" + ctr3.ToString() } })</font>  </li>
                                                    <br />
                                                </ul>

                                            </div>
                                        </div>
                                    </div>






                                    ctr3++;
                                    //stocks[ctr3] = totaleq;
                                    totaleq = 0;
                                }
                            }


                            <input type="hidden" value=@ctr3.ToString() id="txtctr" name="txtctr" />
                            <a href="#"><button id="btnNext" class="button" onclick="SET()">NEXT</button> </a>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
		var id = [null]
		var rate = [null];
		var quantity = [null];
		var total = [null];
		var stot = [null]
		var ttotal = 0.00;
		var txtctr = parseInt($('#txtctr').val());
		var quane;
		var test = [null];

		var boo = function (element) {
			return element == false;
		}

		function SET() {
			for (var pppp = 0; pppp <= txtctr - 1; pppp++) {
				var sto = 0;
                var quan = 0;
                var tots = 0;
                var rate1 = 0;
				id[pppp] = $('#eid' + pppp).val();
				quantity[pppp] = $('#txtQuantity' + pppp).val();
				quan = $('#txtQuantity' + pppp).val();
                sto = document.getElementById('svalue ' + pppp).value;
                tots = sto - quan;
                if (tots>=0) {
                    test[pppp] = true;
                }
				else {
					test[pppp] = false;
                }

                rate[pppp] = $('#txtRate1' + pppp).val();
				total[pppp] = quantity[pppp] * rate[pppp];
				var ttotal = ttotal + total[pppp];
			}
			if (test.some(boo)) {
				alert('Insuficient equipment stock');
			}
			else {
				$.post('/Reserve/Choose_Equipment', $.param({ data: quantity, datar: rate }, true));
				var url = '@Url.Action("Summary", "Reserve")';
				window.location.href = url;
			}
		}
    </script>
    <br />
    <br />
    <br />
    <br />
    <!-- Footer -->
    @*<footer  style=" background-color:#282828; padding: 10px; text-align: center;color: white;">
            <p> <center><img src="~/Content/logo.png" width="180" height="80" /> </center></p>
            <p><i class="fa fa-map-marker w3-text-green w3-xlarge"></i>  8505 Hon. A Sandoval Ave., Brgy. Pinagbuhatan Pasig City</p>
            <p><i class="fa fa-phone w3-text-green w3-xlarge"></i>  (632) 571-2347, (632) 571-0966</p>
            <p><i class="fa fa-envelope-o w3-text-green w3-xlarge"></i>  palmdalecondominium@yahoo.com</p>
            <p>&copy; @DateTime.Now.Year -Palmdale Heights Condominium</p>

        </footer>*@

</body>
</html>