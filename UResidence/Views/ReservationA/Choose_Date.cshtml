@{
	ViewBag.Title = "Choose_Date";
    Layout = "~/Views/Layout/ReservationLayout.cshtml";
}
@using (Html.BeginForm("Choose_Date", "ReservationA", FormMethod.Post))
{
	@Html.AntiForgeryToken()


	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">


		<style>
			.button {
				padding: 15px 25px;
				font-size: 15px;
				text-align: center;
				cursor: pointer;
				outline: none;
				color: #fff;
				background-color: #09442c;
				border: none;
				border-radius: 5px;
				float:right;
				text-decoration:none;
				text-decoration-color:none;

				
			}



				.button:hover {
					background-color: #0e6742;
				}


			div.card {
				width: 700px;
				height: 450px;
				box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
				padding: 10px;
			}
		</style>




	</head>
	<body> 
	
		<br/>
		<center>
			<!--Progress bar start-->
			<div>
				<div class="progress" style="width:860px;height:40px;">
					<div class="progress-bar progress-bar-success " role="progressbar" aria-valuenow="20"
						 aria-valuemin="0" aria-valuemax="100" style="width:20%;">
						<a href="@Url.Action("Amenity","ReservationA") " style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif; padding-top:1em"> <font color="white" size="3">Choose Amenity</font></p></a>
					</div>


					<div class="progress-bar progress-bar-success" style="width:20%;" role="progressbar" aria-valuenow="0"
						 aria-valuemin="0" aria-valuemax="100">
						<a href="@Url.Action("Calendar","ReservationA")"style="text-decoration:none;"><p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Scheduled Amenity</font> </p></a>
					</div>


					<div class="progress-bar progress-bar-success progress-bar-striped active" style="width:20%;" role="progressbar" aria-valuenow="0"
						 aria-valuemin="0" aria-valuemax="100">			
						<p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Choose Date</font> </p>
					</div>

					<div class="progress-bar " style="background-color:#979797; width:20%;" role="progressbar" aria-valuenow="0"
						 aria-valuemin="0" aria-valuemax="100">
						<p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Choose Equipment</font> </p>
					</div>
					<div class="progress-bar  " style="background-color:#979797; width:20%;" role="progressbar" aria-valuenow="0"
						 aria-valuemin="0" aria-valuemax="100">
						<p style="font-family:Arial, Helvetica, sans-serif;padding-top:1em"> <font color="white" size="3">Summary</font> </p>
					</div>
				</div>

				<!--Progress bar end-->
			</div>
			</center>

	<div id="main">


		<div class="w3-container w3-padding-64 w3-theme-l5" id="cdate">
			<div class="w3-row">
				<div class="w3-col m5">
					<div class="w3-padding-16"><span class="w3-xlarge w3-border-green w3-bottombar">Choose Time and Date</span></div>




					<br />
					<img src="~/Content/WebImages/datetime2.png" style="width:70%" />

				</div>

				<!--Card start-->
				<br />
				<div class="w3-col m7">
					<div class="card">

						<div class="w3-section">



							<table>

								<tr>
									<td> &nbsp;  <label> Start Date: </label>  <input type="date" onselect="Set()" class="w3-input" id="sd" name="sd" required style="float:left; width:350px;" /> </td>
									<td> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <label> Start Time: </label>  <input type="time" onselect="myFunction()" class="w3-input" min="08:00" max="20:00" id="st" name="st" required style="float:right; width:350px; padding-bottom:18px;" />  </td>
								</tr>
							</table>

						</div>

						<br />
						<div class="w3-section">



							<table>
								<tr>
									<td> &nbsp; <label> End Date: </label> <input type="date" class="w3-input" id="ed" name="ed" readonly="readonly" style="float:left; width:350px;" /> </td>
									<td> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <label> End Time: </label><input type="time" class="w3-input" min="09:00" max="21:00" id="et" name="et" required style="float:right; width:350px; padding-bottom:18px;" /></td>
								</tr>
							</table>
						</div>

						<br />
						<div class="w3-section">
							<label>Rate :</label>

							<input type="text" id="rate" class="w3-input" disabled="disabled" />

							<input type="hidden" id="stime" name="stime" />
							<input type="hidden" id="etime" name="etime" />
							<input type="hidden" id="tratee" name="tratee" />
							<input type="hidden" id="qwe" name="qwe" />
							<input type="hidden" id="abc" name="abc" />

						</div>

						<div class="w3-section">


							<button name="submit" type="submit" button class="button" onclick="Check()"> Next</button>
						</div>



					</div>
				</div>

			</div>
		</div>
	</div>

	<footer class="w3-center  w3-dark-gray w3-padding-16 w3-text-white " style="position:relative; left: 0; bottom: 0; width:100%; text-align:center; overflow:hidden;">
		<p>&copy; @DateTime.Now.Year -Palmdale Heights Condominium</p>
	</footer>
</body>



}


<script type="text/javascript">
	var startTime;
	var endTime;
	var selectedValue;
	var startT;
	var endT;
	var startDate;
	var endDate;
	var rate1=@ViewBag.Message;
	var rateA;
	var statuset="Valid";
	var statusst="Valid";
	function ValidateDate() {
		var x = $('#sd').val();
		var y = $('#et').val();
		var z = $('#st').val();
		if (x == " " && y == " " && z == " ") {
			alert("Please fill up all required fields");
		}
	}
	function toStandardTime(value) {
		if (value !== null && value !== undefined) { //If value is passed in
			if (value.indexOf('AM') > -1 || value.indexOf('PM') > -1) { //If time is already in standard time then don't format.
				return value;
			}
			else {
				if (value.length == 8) { //If value is the expected length for military time then process to standard time.
					var hour = value.substring(0, 2); //Extract hour
					var minutes = value.substring(3, 5); //Extract minutes
					var identifier = 'AM'; //Initialize AM PM identifier

					if (hour == 12) { //If hour is 12 then should set AM PM identifier to PM
						identifier = 'PM';
					}
					if (hour == 0) { //If hour is 0 then set to 12 for standard time 12 AM
						hour = 12;
					}
					if (hour > 12) { //If hour is greater than 12 then convert to standard 12 hour format and set the AM PM identifier to PM
						hour = hour - 12;
						identifier = 'PM';
					}
					return hour + ':' + minutes + ' '; //Return the constructed standard time
				}
				else { //If value is not the expected length than just return the value as is
					return value;
				}
			}
		}
	}
	$(document).ready(
		function () {
			$('#sd').change(function () {
				selectedValue = $(this).val();
				document.getElementById('ed').value = selectedValue;
				startDate = selectedValue;
				endDate = selectedValue;
				var q = new Date();
				var MyDateString = q.getFullYear() + '-' + ('0' + (q.getMonth() + 1)).slice(-2) + '-' + ('0' + q.getDate()).slice(-2);;
				if (startDate < MyDateString)
				{
					alert("the input is earlier than today");
					document.getElementById('sd').value = null;
					document.getElementById('ed').value = null;
				}
			});

		});

	$(document).ready(function () {
		$('#st').change(function myFunction() {
			selectedValue = $('#st').val();

			var fhours = parseInt(selectedValue.split(':')[0], 10) + 1;
			var fmins = selectedValue.split(':')[1];
			var f = selectedValue.split(' ')[2];
			var final = fhours + ":" + fmins;
			document.getElementById('et').value = final;

			endTime = $('#et').val();




			startTime = $(this).val();
			startT = parseInt(startTime.split(':')[0], 10);
			if (startT < 8 && startT > 21) {
				alert("Start Time is invalid, 8:00 AM - 8:00 PM only");
				document.getElementById('st').value = startTime + ":PM";
				document.getElementById('rate').value = 0;

			}

			if (endTime != null) {
				var hourDiff =
					parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
				rateA = rate1 * hourDiff
				document.getElementById('rate').value = rateA;

			}


		});
		});


		//$(document).ready(function () {
		//	$('#st').change(function myFunction() {
		//		selectedValue = $('#st').val();

		//		var d = new Date(); // for now
		//		d.getHours(); // => 9
		//		d.getMinutes(); // =>  30
		//		d.getSeconds(); // => 51
		//		var MyDateString = d.getHours() + ':' + ('0' + (d.getMinutes() + 1)).slice(-2);


		//		document.getElementById('qwe').value = MyDateString;

		//		document.getElementById('abc').value = selectedValue;

		//		if (selectedValue < MyDateString)
		//		{
		//			alert("BAWAL YAN NANAY");
		//			document.getElementById('st').value = null;
		//			document.getElementById('et').value = null;
		//		}


		//	});
		//});



	$(document).ready(function () {
		$('#st').change(function myFunction() {
		});
		selectedValue = $(this).val();
		document.getElementById('et').value = selectedValue;

	});
	$(document).ready(function () {
		$('#et').change(function myFunction() {
			endTime = $(this).val();

			var endT = parseInt(endTime.split(':')[0], 10);


			if (endT >= 9 && endT <= 21) {
				if ((startT >= 8 && startT <= 20) && (endT >= 9 && endT <= 21)) {
					if (endT > startT) {
						var hourDiff =
							parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
						rateA = rate1 * hourDiff
						document.getElementById('rate').value = rateA;
						statuset = "Valid";

					}
					else
					{
						statuset = "Invalid";
					}
				}
				else {

					var hourDiff =
						parseInt(endTime.split(':')[0], 10) - parseInt(startTime.split(':')[0], 10);
					rateA = ((rate1 * 2) * hourDiff)
					document.getElementById('rate').value = 0;
					statuset = "Invalid";

				}
			}
			else {
				alert("End Time is invalid 9:00 AM - 9:00 PM only");
				document.getElementById('et').value = "PM";
				document.getElementById('rate').value = 0;
				statuset = "Invalid";

			}


		});
	});
	function Check() {
		if (statusst == 'Valid' && statuset == 'Valid') {
			var stconcat = startDate + " " + startTime;
			var etconcat = endDate + " " + endTime;
			var cdrate = rateA;
			document.getElementById('stime').value = stconcat;
			document.getElementById('etime').value = etconcat;
			document.getElementById('tratee').value = cdrate;
		}
		else {
			alert('Invalid');
		}
	};


</script>