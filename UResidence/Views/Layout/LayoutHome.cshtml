
@{
    Layout = "";

}

<!DOCTYPE html>
<html>

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<link rel="icon" href="~/Content/Logo/palmdale.png" type="image/x-icon" />

@Styles.Render("~/Content/css")
@Scripts.Render("~/bundles/modernizr")
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>


<head>
	<style>
		.dropdown-menu {
			background: #2a2a2a;
		}

		.navbar {
			padding: 0.5em 2em;
			position: absolute;
			top: 0;
			width: 100%;
			background: #2a2a2a;
		}

		/* Underline From Center */
		.hvr-underline-from-center {
			display: inline-block;
			vertical-align: middle;
			-webkit-transform: translateZ(0);
			transform: translateZ(0);
			box-shadow: 0 0 1px rgba(0, 0, 0, 0);
			-webkit-backface-visibility: hidden;
			backface-visibility: hidden;
			-moz-osx-font-smoothing: grayscale;
			position: relative;
			overflow: hidden;
		}

			.hvr-underline-from-center:before {
				content: "";
				position: absolute;
				z-index: -1;
				left: 50%;
				right: 50%;
				bottom: 0;
				background: #20d13d;
				height: 4px;
				-webkit-transition-property: left, right;
				transition-property: left, right;
				-webkit-transition-duration: 0.3s;
				transition-duration: 0.3s;
				-webkit-transition-timing-function: ease-out;
				transition-timing-function: ease-out;
			}

			.hvr-underline-from-center:hover:before, .hvr-underline-from-center:focus:before, .hvr-underline-from-center:active:before {
				left: 0;
				right: 0;
			}

		.noti-content {
			position: fixed;
			right: 100px;
			background: #e5e5e5;
			border-radius: 4px;
			top: 47px;
			width: 250px;
			display: none;
			border: 1px solid #9E988B;
		}

		ul#notiContent {
			max-height: 200px;
			overflow: auto;
			padding: 0px;
			margin: 0px;
			padding-left: 20px;
		}

			ul#notiContent li {
				margin: 3px;
				padding: 6px;
				background: #fff;
			}

		.noti-top-arrow {
			border-color: transparent;
			border-bottom-color: #F5DEB3;
			border-style: dashed dashed solid;
			border-width: 0 8.5px 8.5px;
			position: absolute;
			right: 32px;
			top: -8px;
		}

		span.noti {
			color: #FF2323;
			margin: 15px;
			position: fixed;
			right: 100px;
			font-size: 18px;
			cursor: pointer;
		}

		span.count {
			position: relative;
			top: -3px;
		}
	</style>
</head>

<body>
    @*---Modal for Update Profile Picture---*@
    <div class="container">
        <div class="modal fade" id="updateprofilepicture" role="dialog">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body">
                        <input type="file" id="image" name="image" />
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-success" id="btnUpdateProfile" name="btnUpdateProfile" onclick="UpdateProfilePic()">Update</button>
                        <button type="button" class="btn btn-danger" id="btnCloseImageProfile" name="btnCloseImageProfile" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!--NAVBAR TOH-->


    <nav class="navbar navbar-inverse ">
        @*<nav class=" fill">*@
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <center><img src="~/Content/logo.png" width="190" height="70" /> </center>
            </div>
            <br />
            <div class="collapse navbar-collapse" id="myNavbar">

                <center>
                    <ul class="nav navbar-nav navbar-right">
                        <li><a href="~/Reserve/Home" class="hvr-underline-from-center" style="text-decoration:none; "> Home </a></li>
                        <li><a class="hvr-underline-from-center" href="#" name="btnAbout" id="btnAbout" style="text-decoration-color:none; text-decoration:none;"> About Us</a></li>
                        <li><a class="hvr-underline-from-center" href="#" name="btnContact" id="btnContact" style="text-decoration-color:none; text-decoration:none;"> Contact Us</a></li>
                        <li> <a href="~/Reserve/Amenity" class="hvr-underline-from-center" style="text-decoration:none;"> Reserve Now </a></li>

                        <li class="dropdown">

                            <a class="dropdown-toggle hvr-underline-from-center" data-toggle="dropdown" href="#" id="notifBell"> <span class="glyphicon glyphicon-bell"> </span> Notification<span class="count">&nbsp;</span> <span class="caret"></span> </a>

                            <ul class="dropdown-menu" id="hello"></ul>

                        </li>



                        <li class="dropdown">
                            <a class="dropdown-toggle hvr-underline-from-center" data-toggle="dropdown" href="#"><span class="glyphicon glyphicon-user"> </span> My Profile <span class="caret"></span> </a>

                            <ul class="dropdown-menu">

                                <li>
                                    <a href="#" id="OpenModal" name="OpenModal" data-dismiss="modal">
                                        <p class="w3-center"><img src="@Url.Content(Session["URLL"].ToString())" class="w3-circle" style="height:106px; width:106px" alt="user" /></p>

                                    </a>
                                </li>




                                <li><a href="~/Reserve/CalendarViewOT" class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;"><span class="glyphicon glyphicon-calendar"> Schedule</span></a> </li>

                                <li><a href="~/Billing/BillingView" class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;"> Bills and Payment</a></li>




                                <li><a href=@Url.Action("OwnerAccountSetting", "AccountSetting") class="hvr-underline-from-center" style="text-decoration:none; text-decoration-color:none;color: white;"><span class="glyphicon glyphicon-cog">Account Settings</span></a> </li>

                                <li><a href=@Url.Action("Index","Login") class="hvr-underline-from-center" style="text-decoration:none; text-decoration-color:none;color: white;"> <span class="glyphicon glyphicon-log-in"></span> Logout </a></li>
                            </ul>

                        </li>
                    </ul>
                </center>



            </div>
        </div>
    </nav>

    @RenderBody()

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
    <script>
		var myVar = setInterval(updateNotif, 3000);
		var list =0;
		var count=0;
		var counter=0;
		$('#notifBell').click(function () {
            $('span.count', this).html('&nbsp;');
			updateVisit();
			$('#hello').empty();
			$('.noti-content').hide();
			//$('#himodal').modal();
		})

		function getNotif() {
            $.ajax({
                type:'get',
                url: '/Reserve/GetCount',
                success: function (data) {
                    updateNotificationCount(data);
                },
                error: function (data) {

                }
            });

		}

		function updateNotif() {

			$('#hello').append($('<li>Loading...</li>'));

			$.ajax({
				type: 'GET',
				url: '/Reserve/GetNotificationContacts',
				success: function (response) {

					if (response.length == 0) {
						$('#hello').append($('<li>No data available</li>'));
					}
					$.each(response, function (index, value) {
						$('#hello').append($('<li  class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;">New contact : ' + value.ContactName + ' (' + value.ContactNo + ') added</li>'));
                    });

                    getNotif();

				},
				error: function (error) {
					console.log(error);
				}
			})
		}
        function updateVisit() {
            $('#hello').empty();
            $.ajax({
                type: 'POST',
                url: '/Reserve/UpdateNotif',
                success: function (response) {
                    if (response.count == 0) {
                        $('#hello').append($('<li>No data available</li>'));
                    }

                    $.each(response, function (index, value) {
						$('#hello').append($('<li  class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;">New contact : ' + value.ContactName + ' (' + value.ContactNo + ') added</li>'));
                    });

                    getNotif();
                },
                error: function (data) {

                }
            });
        }
		function updateNotificationCount(count) {
			if (count == 0) {
                $('span.count').html('&nbsp;');

			}
			else {
				$('span.count').html(count);
			}
		}

		function w3_open() {
			document.getElementById("main").style.marginLeft = "25%";
			document.getElementById("mySidebar").style.width = "25%";
			document.getElementById("mySidebar").style.display = "block";
			document.getElementById("openNav").style.display = 'none';
		}
		function w3_close() {
			document.getElementById("main").style.marginLeft = "0%";
			document.getElementById("mySidebar").style.display = "none";
			document.getElementById("openNav").style.display = "inline-block";
		}

		function UpdateProfilePic() {
			var id = @Session["UID"];

			var file = $("#image").get(0).files;
			var data = new FormData();
			data.append("Image", file[0]);
			data.append("Id", id);
			$.ajax({
				type: "POST",
				url: "/owner/UpdateImage/",
				data: data,
				contentType: false,
				processData: false,
				success: function (data) {
					if (data == true) {
						alert('Success');
						window.location.reload();
						window.location.href = window.location.href + "?rnd=" + Math.random()

					}
				},
				error: function (error) {
					alert(error);
				}
			});
		}


		$('#btnCloseImageProfile').click(function () {

			$('#updateprofilepicture').hide();
		}
		);


		$('#OpenModal').click(function () {

			$('#updateprofilepicture').modal();
		}
		);




		var myVar = setInterval(updateNotif, 3000);
		var list =0;
		var count=0;
		var counter=0;
		$('#notifBell').click(function () {
            //$('span.count', this).html('&nbsp;');
            updateVisit();
			$('.noti-content').hide();
			//$('#himodal').modal();
		})

		function getNotif() {
            $.ajax({
                type:'get',
                url: '/Reserve/GetCount',
                success: function (data) {
                    updateNotificationCount(data);
                },
                error: function (data) {

                }
            });

		}

		function updateNotif() {
			$('#hello').empty();
			$('#hello').append($('<li>Loading...</li>'));

			$.ajax({
				type: 'GET',
				url: '/Reserve/GetNotificationContacts',
				success: function (response) {


					$('#hello').empty();
					if (response.length == 0) {
                        $('#hello').append($('<li style="text-decoration:none;text-decoration-color:none;color: white;">No data available</li>'));
					}
                    $.each(response, function (index, value) {
                        if (value.Visit = 0) {
                            $('#hello').append($('<li style="text-decoration:none;text-decoration-color:none;color: white;">No data available</li>'));

                        }
                        else {
                            $('#hello').append($('<li  class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;">' + value.Description + '<p class="timestamp">' + moment(value.Date).format("DD/MMM/YYYY hh:mm a")+ '<p><hR></li>'));

                        }
                    });

                    getNotif();

				},
				error: function (error) {
					console.log(error);
				}
			})
		}
        function updateVisit() {
            $('#hello').empty();
            $.ajax({
                type: 'POST',
                url: '/Reserve/UpdateNotif',
                success: function (response) {
                    if (response.count == 0) {
                        $('#hello').append($('<li style="text-decoration:none;text-decoration-color:none;color: white;">No data available</li>'));
                    }

                    $.each(response, function (index, value) {
                        if (value.Visit = 0) {
                            $('#hello').append($('<li  class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white; background-color:#a6d1ff;">New : ' + value.Description + '<p class="timestamp">' + moment(value.Date).format("DD/MMM/YYYY hh:mm a")+'</p><hr></li>'));

                        }
                        else {
                            $('#hello').append($('<li  class="hvr-underline-from-center" style="text-decoration:none;text-decoration-color:none;color: white;">' + value.Description + '<p class="timestamp">' + value.Date + '<p><hR></li>'));

                        }
                    });

                    getNotif();
                },
                error: function (data) {

                }
            });
        }
		function updateNotificationCount(count) {
			if (count == 0) {
                $('span.count').html('&nbsp;');

			}
			else {
				$('span.count').html(count);
			}
		}

		function w3_open() {
			document.getElementById("main").style.marginLeft = "25%";
			document.getElementById("mySidebar").style.width = "25%";
			document.getElementById("mySidebar").style.display = "block";
			document.getElementById("openNav").style.display = 'none';
		}
		function w3_close() {
			document.getElementById("main").style.marginLeft = "0%";
			document.getElementById("mySidebar").style.display = "none";
			document.getElementById("openNav").style.display = "inline-block";
		}

		function UpdateProfilePic() {
			var id = @Session["UID"];

			var file = $("#image").get(0).files;
			var data = new FormData();
			data.append("Image", file[0]);
			data.append("Id", id);
			$.ajax({
				type: "POST",
				url: "/owner/UpdateImage/",
				data: data,
				contentType: false,
				processData: false,
				success: function (data) {
					if (data == true) {
						alert('Success');
						window.location.reload();
						window.location.href = window.location.href + "?rnd=" + Math.random()

					}
				},
				error: function (error) {
					alert(error);
				}
			});
		}


		$('#btnCloseImageProfile').click(function () {

			$('#updateprofilepicture').hide();
		}
		);


		$('#OpenModal').click(function () {

			$('#updateprofilepicture').modal();
		}
		);



    </script>




</body>
</html>
