@model List<UResidence.Amenity>
@{
	string pending = "pending";
	string reserved = "reserved";
	string cancelled = "cancelled";
	Layout = "/Views/Layout/FinanceLayout.cshtml";
}


@*Scripts for dropdown*@
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
@using (Html.BeginForm("CalendarView", "Calendar", FormMethod.Post))
{
	@Html.AntiForgeryToken()




	<head>
		<style type='text/css'>
			.my-legend .legend-scale ul li {
				font-size: 80%;
				list-style: none;
				margin-left: 0;
				line-height: 18px;
				margin-bottom: 2px;
			}

			.my-legend ul.legend-labels li span {
				display: block;
				float: left;
				height: 16px;
				width: 30px;
				margin-right: 5px;
				margin-left: 0;
				border: 1px solid #999;
			}
		</style>
	</head>
	<br />
	<br />



	<body>
		<br />
		<br />
		<div class="container">
			<div class="modal fade" id="myModal" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span id="eventTitle"></span></h4>
						</div>
						<div class="modal-body">
							<input type="hidden" name="rid" id="rid" />
							<input type="hidden" name="rfid" id="rfid" />
							<p id="pDetails"></p>
							<br /><br />
							<button type="button" class="btn btn-primary" id="btnPayment" name="btnPayment" data-dismiss="modal">Record Payment</button>
							<button type="button" class="btn btn-default" id="btnReversal" name="btnReversal" data-dismiss="modal">Add Reversal</button>
							<button type="button" class="btn btn-success" id="btnCModal" name="btnCModal" data-dismiss="modal">Update Status</button>


						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>




		<div class="container">
			<div class="modal fade" id="viewDetailsModal" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Swimming Details</span></h4>
						</div>
						<div class="modal-body">
							<p id="sDetails"></p>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" id="btnCloseS" name="btnCloseS" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>




		<div class="container">
			<div class="modal fade" id="paymentModal" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Payment</span></h4>
						</div>
						<div class="modal-body">
							<b>Payment: </b><input type="number" name="dp" id="dp" min="0" value="0" />
							<br /><br />
							<b>Description: </b><textarea class="form-control" id="pdescription" name="pdescription"></textarea>
							<br /><br />
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-primary" id="btnAddPayment" name="btnAddPayment" onclick="AddPayment()">Add Payment</button>
							<button type="button" class="btn btn-info" id="btnHistory" name="btnHistory" data-dismiss="modal" onclick="ReceiptHistory()">Payment History</button>
							<button type="button" class="btn btn-danger" id="btnCloseP" name="btnCloseP" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="modal fade" id="reversalModal" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Reversal</span></h4>
						</div>
						<div class="modal-body">

							<b>Total Payment:</b> <label id="tpr" name="tpr"></label>
							<br /><br />
							<b>Amount to Return: </b><input type="number" name="atr" id="atr" min="0" value="0" required />
							<br /><br />
							<b>Description: </b><textarea class="form-control" id="rdescription" name="rdescription" required></textarea>
							<br /><br />

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-success" id="btnAddReversal" name="btnAddReversal" onclick="AddReversal()">Add Reversal</button>
							<button type="button" class="btn btn-default" id="btnHistoryReversal" name="btnHistoryReversal" onclick="ReversalHistory()" data-dismiss="modal">Reversal History</button>
							<button type="button" class="btn btn-danger" id="btnCloseR" name="btnCloseR" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="modal fade" id="UpdateModal" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
						</div>
						<div class="modal-body">
							<b>Status: </b><select id="mySelect" name="mySelect">
								<option value="Pending">Pending</option>
								<option value="Reserved">Reserved</option>
								<option value="Canceled">Canceled</option>
							</select>
							<br /><br />
							<b>Current Charge: </b><label name="cg" id="cg" min="0"></label>
							<br /><br />
							<b>Add Charge: </b><input type="number" name="cg1" id="cg1" min="0" value="0" required />
							<br /><br />
							<b>Description: </b><textarea name="cdescription" id="cdescription" required></textarea>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-success" id="btnUpdate" name="btnUpdate" onclick="UpdateStatus()">Save Changes</button>
							<button type="button" class="btn btn-info" id="btnCHistory" name="btnCHistory" onclick="ChargeHistory()">Charge History</button>
							<button type="button" class="btn btn-danger" id="btnCloseU" name="btnCloseU" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="modal fade" id="PaymentHistory" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Payment History</span></h4>
						</div>
						<div class="modal-body">
							<table class="table table-bordered table-striped" name="tbHistory" id="tbHistory" style="overflow-y:scroll;height:200px;display:block;"></table>
							<b>Total Payment :</b><label id="txtTotalPayment" name="txtTotalPayment"></label>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" id="btnCloseRH" name="btnCloseRH" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="modal fade" id="ReversalHistory" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Reversal History</span></h4>
						</div>
						<div class="modal-body">
							<table class="table table-bordered table-striped" name="tbRevHistory" id="tbRevHistory" style="overflow-y:scroll;height:200px;display:block;"></table>
							<b>Total Reversal :</b><label id="txtTotalReversal" name="txtTotalReversal"></label>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" id="btnCloseRevH" name="btnCloseRevH" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="container">
			<div class="modal fade" id="ChargeHistory" role="dialog">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal">&times;</button>
							<h4 class="modal-title"><span>Charge History</span></h4>
						</div>
						<div class="modal-body">
							<table class="table table-bordered table-striped" name="tbCHistory" id="tbCHistory" style="overflow-y:scroll;height:200px;display:block;"></table>
							<b>Total Charge :</b><label id="txtCharge" name="txtCharge"></label>

						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-danger" id="btnCloseCH" name="btnCloseCH" data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
			</div>
		</div>

		<div class="panel panel-default">
			<div class="panel-body">
				<div class="pull-right">
					<div class="btn-group">

						<button type="button" class="btn btn-success btn-filter " value="Reserved" onclick="RefreshCalendar('@reserved')">Reserved</button>
						<button type="button" class="btn btn-warning btn-filter " value="Pending" onclick="RefreshCalendar('@pending')">Pending</button>
						<button type="button" class="btn btn-danger btn-filter" value="Cancelled" onclick="RefreshCalendar('@cancelled')">Cancelled</button>
						@*<button type="button" class="btn btn-default btn-filter" data-target="all">Todos</button>*@

					</div>
				</div>
				<br />


				<div id="calendar" class="container">
					<br />

					<label><b>Legends</b></label>
					@foreach (Amenity amn in Model)
					{
						<div class='my-legend'>
							<div class='legend-scale'>
								<ul class='legend-labels'>
									<li><span style='background:@amn.Color;'></span>@amn.AmenityName</li>
								</ul>
							</div>
						</div>
					}
				</div>

			</div>
		</div>

	</body>
	<br />

	<link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.min.css" rel="stylesheet" />
	<link href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.print.css" rel="stylesheet" media="print" />
}

@section scripts{
	<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.18.1/moment.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.min.js"></script>


	<script>

            function AddPayment() {
                var refno = document.getElementById('rfid').value;
                var payment = document.getElementById('dp').value;
                var q = new Date();
                var MyDateString = q.getFullYear() + '-' + ('0' + (q.getMonth() + 1)).slice(-2) + '-' + ('0' + q.getDate()).slice(-2);;
                var description = document.getElementById('pdescription').value;
                var name = "@Session["Fullname"]";

                var data1 = {
                    RefNo: refno,
                    Totalpayment: payment,
                    Date: MyDateString,
                    Description: description,
                    CreatedBy: name
                };


                $.ajax({
                    type: "POST",
                    url: "/calendar/InsertPayment",
                    data: data1,
                    success: function (data) {
                        if (data == true) {
                            $('#paymentModal').modal('hide');
                            RefreshCalendar();
                            alert('Success');
                            window.location.reload();
                            //window.location.href = window.location.href + "?rnd=" + Math.random();
                            $('#myModal').modal();
                        }


                    },
                    error: function (error) {
                        alert('failed');
                    }
                });
            }

            function ChargeHistory() {
                var refno = document.getElementById('rfid').value;
                $.ajax({
                    type: "POST",
                    url: "/calendar/ChargeHistory",
                    dataType: 'json',
                    data: {
                        'refno1': refno
                    },
                    success: function (data) {
                        var totalp = 0;
                        var trHTML = '';
                        format: 'yyyy-mm',

                                $('#tbCHistory').empty();
                            trHTML = '<tr><th>Date</th> <th>Charge</th> <th>Description</th> <th>Created By</th></tr>';
                            $.each(data, function (i, v) {
                                trHTML += '<tr><td>' + moment(v.Date).format("DD/MMM/YYYY hh:mm a") + '</td><td>' + v.charge + '</td><td>' + v.Description + '</td><td>' + v.CreatedBy + '</td></tr>';
                                totalp += v.charge;
                            });
                            $('#tbCHistory').append(trHTML);
                            document.getElementById('txtCharge').innerHTML = totalp;
                        trHTML = '';
                        },
                    error: function (error) {
                        alert('Failed to retrieve the record');
                    }
                });
            }



            function ReceiptHistory() {
				var refno = document.getElementById('rfid').value;

                $.ajax({
                    type: "POST",
                    url: "/calendar/ReceiptHistory",
                    dataType: 'json',
                    data: {
                        'refno1': refno
                    },
                    success: function (data) {
                        var totalp = 0;
                        var trHTML = '';
						format: 'yyyy-mm',


                        $('#tbHistory').empty();
                        trHTML = '<tr><th>Date</th> <th>Payment</th> <th>Description</th> <th>Created By</th></tr>';
                        $.each(data, function (i, v) {
                            trHTML += '<tr><td>' + moment(v.Date).format("DD/MMM/YYYY hh:mm a")+ '</td><td>' + v.Totalpayment + '</td><td>' + v.Description + '</td><td>' + v.CreatedBy + '</td></tr>';
                            totalp += v.Totalpayment;
                        });
                        $('#tbHistory').append(trHTML);
                        document.getElementById('txtTotalPayment').innerHTML  = totalp;
                        trHTML = '';
                    },
                    error: function (error) {
                        alert('Failed to retrieve the record');
                    }
                });
			}

            function ReversalHistory() {
                var refno = document.getElementById('rfid').value;

                $.ajax({
                    type:'POST',
                    url: "/calendar/ReversalHistory",
                    dataType: 'json',
                    data: {
                        'refno1': refno
                    },
                    success: function (data) {
                        var totalp = 0;
                        var trHTML = '';
                        format: 'yyyy-mm',


                            $('#tbRevHistory').empty();
                        trHTML = '<tr><th>Date</th> <th>Amount</th> <th>Description</th> <th>Created By</th><th>Status</th></tr>';
                        $.each(data, function (i, v) {
                            trHTML += '<tr><td>' + moment(v.Date).format("DD/MMM/YYYY hh:mm a") + '</td><td>' + v.Amount + '</td><td>' + v.Description + '</td><td>' + v.CreatedBy + '</td><td>' + v.Status + '</td></tr>';
                            totalp += v.Amount;
                        });
                        $('#tbRevHistory').append(trHTML);
                        document.getElementById('txtTotalReversal').innerHTML = totalp;
                        trHTML = '';
                    },
                    error: function (error) {
                        alert('Failed to retrieve the record');
                    }
                });
            }

			function ToJavaScriptDate(value) {
				var pattern = /Date\(([^)]+)\)/;
				var results = pattern.exec(value);
				var dt = new Date(parseFloat(results[1]));
				return (dt.getMonth() + 1) + "/" + dt.getDate() + "/" + dt.getFullYear() + "-" + dt.getHours() + ":" + dt.getMinutes();
			}


            function UpdateStatus() {
                var refno = document.getElementById('rfid').value;
                var rstatus = document.getElementById('mySelect').value;
                var charge1 = document.getElementById('cg').innerHTML;
                var charge2 = document.getElementById('cg1').value;
                var charge = charge1 + charge2;
                var cdescription = document.getElementById('cdescription').value;
                $.ajax({
                    type: "POST",
                    url: "/calendar/UpdatePayment",
                    dataType: 'json',
                    data: {
                        'rstatus1': rstatus,
                        'charge1': charge,
                        'refno1': refno,
                        'desc': cdescription
                    },
                    success: function (data) {
                        if (data == true) {
                            $('#UpdateModal').modal('hide');
                            RefreshCalendar();
                            window.location.reload();
                            //window.location.href = window.location.href + "?rnd=" + Math.random();
                            $('#myModal').modal();
                        }
                    },
                    error: function (error) {
                        alert('Failed');
                    }
                });
            }

            $(document).ready(function () {
                var status ='Pending';
                var data = {
                    Status:status
                }
                $.ajax({
                    type: "GET",
                    url: "/calendar/GET_EVENTS",
                    data:data,
                    success: function (data) {
                        $.each(data, function (i, v) {
                            events.push({
                                title: v.AName,
                                reserved: v.ReservedBy,
                                start: moment(v.StartTime),
                                end: v.EndTime != null ? moment(v.EndTime) : null,
                                rate: v.Rate,
                                status: v.Status,
                                color: v.Color,
                                dp: v.Total,
                                cg: v.Charge,
                                bn: v.BldgNo,
                                un: v.UnitNo,
                                r: v.RId,
                                rf: v.RFId,
                                tc: v.TableCost,
                                cc: v.ChairCost,
                                amt: v.Amount,
                                cq: v.ChairQuantity,
								tq: v.TableQuantity,
								sid: v.SRId,
								adu: v.Adult,
								chi: v.Child
                            });
                        })
                        GenerateCalendar(events);
                    },
                    error: function (error) {
                        alert('failed');
                    }
                });



            });
                var events = [];
                var d = '';
                var selectedEvent = null;
            var totalpay = 0;



            function RefreshCalendar(stat) {
                if (stat == null) {
                    stat = "Pending";
                }
                var data = {
                    Status:stat
                }
                    events = [];
                    $.ajax({
                        type: "GET",
                        url: "/calendar/GET_EVENTS",
                        data:data,
                        success: function (data) {
                            $.each(data, function (i, v) {
                                events.push({
                                    title: v.AName,
                                    reserved: v.ReservedBy,
                                    start: moment(v.StartTime),
                                    end: v.EndTime != null ? moment(v.EndTime) : null,
                                    rate: v.Rate,
                                    status: v.Status,
                                    color: v.Color,
                                    dp: v.Total,
                                    cg: v.Charge,
                                    bn: v.BldgNo,
                                    un: v.UnitNo,
                                    r: v.RId,
                                    rf: v.RFId,
                                    tc: v.TableCost,
                                    cc: v.ChairCost,
                                    amt: v.Amount,
                                    cq: v.ChairQuantity,
									tq: v.TableQuantity,
									sid: v.SRId,

                                });
                            })
                            GenerateCalendar(events);
                        },
                        error: function (error) {
                            alert('failed');
                        }
                    });


                }


                function GenerateCalendar(events) {
                    $('#calendar').fullCalendar('destroy');
					$('#calendar').fullCalendar({
						contentHeight: 400,
						defaultDate: new Date(),
						timeFormat: 'h(:mm):a',
						header: {
							left: 'prev,next today',
							center: 'title',
							right: 'month,basicWeek,basicDay,agenda'
						},
						eventLimit: true,
						eventColor: '#378006',
						events: events,

						eventClick: function (calEvent, jsEvent, view) {

							if (calEvent.title == 'SwimmingPool') {
								selectedEvent = calEvent;
								$('#myModal #eventTitle').html('<b>Amenity Name: </b>' + calEvent.title);
								var $description = $('<div/>');
								$description.append($('<p/>').html('<b>Reserved By: </b>' + calEvent.reserved));
								$description.append($('<p/>').html('<b>Building No: </b>' + calEvent.bn));
								$description.append($('<p/>').html('<b>Unit No: </b>' + calEvent.un));
								$description.append($('<p/>').html('<b>StartTime: </b>' + calEvent.start.format("DD/MMM/YYYY hh:mm a")));
								$description.append($('<p/>').html('<b>EndTime: </b>' + calEvent.end.format("DD/MMM/YYYY hh:mm a")));
								$description.append($('<p/>').html('<b>Amenity Cost: </b>' + calEvent.rate + '&nbsp;&nbsp;&nbsp;&nbsp;' + '<button type="button" class="btn btn-link" id="viewDetails" name="viewDetails" data-dismiss="modal" onclick="View(' + calEvent.sid + ')">View Details</button>'));
								$description.append($('<p/>').html('<b>Table Quantity: </b>' + calEvent.tq));
								$description.append($('<p/>').html('<b>Table Cost: </b>' + calEvent.tc));
								$description.append($('<p/>').html('<b>Chair Quantity: </b>' + calEvent.cq));
								$description.append($('<p/>').html('<b>Chair Cost: </b>' + calEvent.cc));
								$description.append($('<p/>').html('<b>Charge: </b>' + calEvent.cg));
								$description.append($('<p/>').html('<b>Total Cost: </b>' + ((calEvent.rate + calEvent.tc + calEvent.cc + calEvent.cg))));
								$description.append($('<p/>').html('<b>Reversal Amount: </b>' + (calEvent.amt)));
								$description.append($('<p/>').html('<b>Total Payment: </b>' + (calEvent.dp - calEvent.amt)));
								$description.append($('<p/>').html('<b>Outstanding Total: </b>' + ((calEvent.rate + calEvent.tc + calEvent.cc + calEvent.cg) - (calEvent.dp - calEvent.amt))));
								$description.append($('<p/>').html('<b>Status: </b>' + calEvent.status));
								//+ calEvent.TableCost + calEvent.ChairCost + calEvent.cg) - (calEvent.dp))
								document.getElementById('mySelect').value = calEvent.status;
								//document.getElementById('dp').value = calEvent.dp;
								document.getElementById('rid').value = calEvent.r;
								document.getElementById('rfid').value = calEvent.rf;
								document.getElementById('cg').innerHTML = calEvent.cg;
								totalpay = calEvent.dp;
								document.getElementById('tpr').innerHTML = calEvent.dp;
								$('#myModal #pDetails').empty().html($description);

								$('#myModal').modal();
							}

							else
							{
								selectedEvent = calEvent;
								$('#myModal #eventTitle').html('<b>Amenity Name: </b>' + calEvent.title);
								var $description = $('<div/>');
								$description.append($('<p/>').html('<b>Reserved By: </b>' + calEvent.reserved));
								$description.append($('<p/>').html('<b>Building No: </b>' + calEvent.bn));
								$description.append($('<p/>').html('<b>Unit No: </b>' + calEvent.un));
								$description.append($('<p/>').html('<b>StartTime: </b>' + calEvent.start.format("DD/MMM/YYYY hh:mm a")));
								$description.append($('<p/>').html('<b>EndTime: </b>' + calEvent.end.format("DD/MMM/YYYY hh:mm a")));
								$description.append($('<p/>').html('<b>Amenity Cost: </b>' + calEvent.rate));
								$description.append($('<p/>').html('<b>Table Quantity: </b>' + calEvent.tq));
								$description.append($('<p/>').html('<b>Table Cost: </b>' + calEvent.tc));
								$description.append($('<p/>').html('<b>Chair Quantity: </b>' + calEvent.cq));
								$description.append($('<p/>').html('<b>Chair Cost: </b>' + calEvent.cc));
								$description.append($('<p/>').html('<b>Charge: </b>' + calEvent.cg));
								$description.append($('<p/>').html('<b>Total Cost: </b>' + ((calEvent.rate + calEvent.tc + calEvent.cc + calEvent.cg))));
								$description.append($('<p/>').html('<b>Reversal Amount: </b>' + (calEvent.amt)));
								$description.append($('<p/>').html('<b>Total Payment: </b>' + (calEvent.dp - calEvent.amt)));
								$description.append($('<p/>').html('<b>Outstanding Total: </b>' + ((calEvent.rate + calEvent.tc + calEvent.cc + calEvent.cg) - (calEvent.dp - calEvent.amt))));
								$description.append($('<p/>').html('<b>Status: </b>' + calEvent.status));
								//+ calEvent.TableCost + calEvent.ChairCost + calEvent.cg) - (calEvent.dp))
								document.getElementById('mySelect').value = calEvent.status;
								//document.getElementById('dp').value = calEvent.dp;
								document.getElementById('rid').value = calEvent.r;
								document.getElementById('rfid').value = calEvent.rf;
								document.getElementById('cg').innerHTML = calEvent.cg;
								totalpay = calEvent.dp;
								document.getElementById('tpr').innerHTML = calEvent.dp;
								$('#myModal #pDetails').empty().html($description);

								$('#myModal').modal();
							}
						}
					});
                }

            function AddReversal() {
                var refno = document.getElementById('rfid').value;
                var ar = document.getElementById('atr').value;
                var desc = document.getElementById('rdescription').value;
                var select = 'Pending';

                    if (ar <= totalpay) {
                        var data = {
                            RefNo: refno,
                            Description: desc,
                            Status: select,
                            Amount: ar
                        }
                        $.ajax({
                            type: 'POST',
                            url: '/Calendar/AddReversal',
                            data: data,
                            success: function (data) {
                                RefreshCalendar();
                                alert('Success');
                                window.location.reload();
                                $('#myModal').modal();
                            },
                            error: function (error) {
                                alert("Failed to Insert Record");
                            }



                        });
                    }

                else {
                    alert('Amount to Return should be Less than or Equal of the Total payment')
                }


            }
            function Sort() {
                RefreshCalendar();
            }
            $('#btnSave').click(function () {
                if (selectedEvent != null && confirm('Are you sure?')) {

                    SaveEvent(data);
                }
            });
            $('#btnReversal').click(function () {
                $('#reversalModal').modal();

            });

            $('#btnHistoryReversal').click(function () {
                $('#ReversalHistory').modal();
            });
            $('#btnPayment').click(function () {

                $('#paymentModal').modal();
            });
            $('#btnCloseP').click(function () {

                $('#myModal').modal();
            }
            );
            $('#btnCModal').click(function () {

                $('#UpdateModal').modal();
            });
            $('#btnCloseU').click(function () {

                $('#myModal').modal();
            }
            );
            $('#btnCloseRH').click(function () {

                $('#paymentModal').modal();
            }
            );
            $('#btnHistory').click(function () {

                $('#PaymentHistory').modal();

            });
            $('#btnCHistory').click(function () {

                $('#ChargeHistory').modal();

            });
            $('#btnCloseCH').click(function () {

                $('#UpdateModal').modal();
            });
            $('#btnCloseR').click(function () {

                $('#myModal').modal();
			});

            $('#btnCloseRevH').click(function () {

                $('#reversalModal').modal();
			});
			//$('#viewDetails').click(function () {
			//	alert('tfhd');
			//

			//});

			function View(Id) {
					var refno = Id;

					$.ajax({
						type: "GET",
						url: "/calendar/SwimmingInfo",
						dataType: 'json',
						data: {
							'refno1': refno
						},
						success: function (data) {
							$.each(data, function (i, v) {
								var $description = $('<div/>');
								$description.append($('<p/>').html('<b>Adult: </b>' + v.Adult));
								$description.append($('<p/>').html('<b>Child: </b>' + v.Child));
								$('#viewDetailsModal #sDetails').empty().html($description);
							})

						},

						error: function (error) {
							alert('Failed to retrieve the record');
						}
					});



				$('#viewDetailsModal').modal();
			}

	</script>

}
